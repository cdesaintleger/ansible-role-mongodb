---

# Role tests

- hosts: 'mongodb-org-vagrant-xenial:mongodb-ent-vagrant-xenial:mongodb-ent-vagrant-xenial:mongodb-ent-docker-xenial'
  name: 'Install tests prerequisites'
  gather_facts: False
  tasks:
    - name: 'PREREQUISITES | APT | Do an apt-get update'
      become: True
      raw: 'apt-get update -qq'
      changed_when: False
    - name: 'PREREQUISITES | APT | Install python 2.7'
      become: True
      raw: 'apt-get install -qq python2.7'
      changed_when: False


# Install pip in testing environment because role dependency is not set
- hosts: 'all'
  name: 'Run role tests'
  pre_tasks:
    - name: 'Install pip on Debian OS family'
      become: True
      apt:
        name: 'python-pip'
        state: 'present'
      when: "(ansible_os_family | lower) == 'debian'"
  roles:
    - role: "{{ role_name }}"
  vars:
    role_name: "{{ playbook_dir | basename }}"
